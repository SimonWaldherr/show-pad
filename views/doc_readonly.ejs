<!-- included by doc.ejs -->
<% script('/js/tinyosf.js') %>
<% stylesheet('/css/tinyosf.css') %>

<span><%- __('showdoc.error.readonly.' + readonlyReason, '/doc/' + docname) %></span>
<div class="alert hidden" id="updateerror"></div>
<div id="docosftext"></div>

<script>
setInterval(getDocText, 1000);
getDocText(true);

function getDocText(first)
{
    $.ajax('/doc/<%=docname%>/text')
        .success
        (
            function (res)
            {
                var parsed = osfParser(res);
                var html = osfExport(parsed);
                $('#docosftext').html(html);
                $('#updateerror').hide();
            }
        )
        .fail
        (
            function (res)
            {
                $('#updateerror').show().text("<%=__('showdoc.readonly.updateerror')%>")
            }
        );
}
</script>
